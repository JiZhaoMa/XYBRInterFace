<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>项目看板</title>
    <style>  
        body {  
            font-family: Arial, sans-serif;  
            height: 100vh;  
            margin: 0;  
        }
        .flowchart-container {  
            display: flex;    
            justify-content: space-around;  
            width: 80%;  
			align-items: center;
            /*max-width: 1600px;  
            overflow-x: auto;  */
        }  
        .stage {  
            width: 60px;  
            height: 60px;  
            border-radius: 5px;  
            display: flex;  
            justify-content: center;  
            align-items: center;  
            font-size: 16px;
            margin: 0.5px;
            padding: 10px;  
            box-sizing: border-box;  
            text-align: center;  
            position: relative;  
            color: #fff;  
        }  
        .connector {  
            width: 40px;  
            height: 40px;  
            display: flex;  
            justify-content: center;  
            align-items: center;  
        }  
        .connector svg {  
            height: 100%;  
            width: auto;  
        }  
        .connector line {  
            stroke: #333;  
            stroke-width: 2;  
            stroke-linecap: round;  
            marker-end: url(#arrowhead);  
        }  
		.process {
			position: absolute;
			bottom: 0;
			left: 0;
			width: 100%;
			height: 20px;
			border-radius: 10px;
			overflow: hidden;
			color:#2196F3;
			top: 110%;
		}
		.project-title{
			height: 5%;
			width: 100%;
			background-color: #37a2da;
			color: #FFF;
			font-size: x-large;
			font-weight: bold;
			justify-content: center;
			align-items: center;
			display: flex;  
		}
		.project-plan-title{
			width: 5%;
			color: darkblue;
			font-size: 18px;
			font-weight: bold;
		}
		.project-plan{
			height: 10%;
			width: 100%;
			position: absolute;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		.project-row-first{
			width: 90%;
			height: 25%;
			/*background-color: #00F7DE;*/
			position: relative;
			top: 13%;
			left: 5%;
			display: flex;
		}
		.project-row-second{
			width: 90%;
			height: 25%;
			/*background-color: #e4b9b9;*/
			position: relative;
			top: 15%;
			left: 5%;
			display: flex;
		}
		.project-row-third{
			width: 92%;
			height: 27%;
			/*background-color: #00BCD4;*/
			position: relative;
			top: 17%;
			left: 5%;
			display: flex;
		}
		.left{
			width: 25%;
			height: 100%;
			border: 0.2px solid #0663A2;
			border-radius: 10px 10px 10px 10px;
		}
		.title{
			width: 30%;
			height: 10%;
			background-color: #FFFFFF;
			color: #0663A2;
			top: -6%;
			position: relative;
			text-align: center;
			left: 5%;
		}
		.tabel-title{
			width: 15%;
			height: 10%;
			background-color: #FFFFFF;
			color: #0663A2;
			top: -6%;
			position: relative;
			text-align: center;
			left: 5%;
		}
		.center{
			width: 23%;
			height: 100%;
			left: 2%;
			position: relative;
			border: 0.2px solid #0663A2;
			border-radius: 10px 10px 10px 10px;
		}
		.right{
			width: 23%;
			height: 100%;
			left: 4%;
			position: relative;
			border: 0.2px solid #0663A2;
			border-radius: 10px 10px 10px 10px;
		}
		.right01{
			width: 25%;
			height: 100%;
			left: 6%;
			position: relative;
			border: 0.2px solid #0663A2;
			border-radius: 10px 10px 10px 10px;
		}
		.third-left{
			width: 49%;
			height: 100%;
			border: 0.2px solid #0663A2;
			border-radius: 10px 10px 10px 10px;
		}
		.third-right{
			left: 2%;
			width: 49%;
			height: 100%;
			border: 0.2px solid #0663A2;
			border-radius: 10px 10px 10px 10px;
			position: relative;
		}
		.echarts-bar{
			width: 100%;
			height: 100%;
			top: -5%;
		}
		.process-color-01 { color: #37a2da; } /* 市场洞察 */
        .process-color-02 { color: #37a2da; } /* 机会分析 */
        .process-color-03 { color: #37a2da; } /* 业务计划 */
        .process-color-04 { color: #37a2da; } /* 产品立项 */
        .process-color-05 { color: #37a2da; } /* 概念 */
        .process-color-06 { color: #37a2da; } /* 计划 */
        .process-color-07 { color: #ff9f7f; } /* 开发 */
        .process-color-08 { color: #ff9f7f; } /* 验证 */
        .process-color-09 { color: #9ea6b9; } /* 发布 */
        .process-color-10 { color: #9ea6b9; } /* 生命周期 */
		
        .market-insights { background-color: #37a2da; } /* 市场洞察 */
        .opportunity-analysis { background-color: #37a2da; } /* 机会分析 */
        .business-plan { background-color: #37a2da; } /* 业务计划 */
        .product-initiation { background-color: #37a2da; } /* 产品立项 */
        .concept { background-color: #37a2da; } /* 概念 */
        .planning { background-color: #37a2da; } /* 计划 */
        .development { background-color: #ff9f7f; } /* 开发 */
        .validation { background-color: #ff9f7f; } /* 验证 */
        .launch { background-color: #9ea6b9; } /* 发布 */
        .lifecycle { background-color: #9ea6b9; } /* 生命周期 */
		table {
			width: 100%; /* 设置table宽度 */
			border-collapse: collapse; /* 边框合并 */
			overflow: auto;
			position: relative;
			font-size: 0.9vw;
			table-layout: fixed;
		}
		th{
			border: 0px; /* 设置单元格边框 */
			padding: 8px; /* 设置单元格内边距 */
			text-align: center; /* 单元格内文本对齐方式 */
			position: sticky;
			background-color: #37a2da;
		}
		td {
			border: 0px; /* 设置单元格边框 */
			padding: 8px; /* 设置单元格内边距 */
			text-align: center; /* 单元格内文本对齐方式 */
			color: #000;
			width: 28%;
			/*word-break: keep-all; !* 不换行 *!*/
			/*white-space: nowrap; !* 不换行 *!*/
			/*overflow: hidden; !* 内容超出宽度时隐藏超出部分的内容 *!*/
			/*text-overflow: ellipsis; !* 当对象内文本溢出时显示省略标记(...) ；需与overflow:hidden;一起使用。*!*/
		}
		/*table td:hover {*/
		/*	overflow: visible;!* 显示 *!*/
		/*	white-space: normal;!* 允许文字自动换行 *!*/
		/*	word-wrap: break-word;!* 文字自动换行 *!*/
		/*}*/
		::-webkit-scrollbar{
			width: 1px;
			height: 24px;
		}
		th {
			text-align: center;
			color: #fff;
			width: 28%;
			font-weight: bold;
		}

		.scroll-box-01 {
			height: 65%;
			width: 100%;
			overflow-y: auto;
			position: relative;
		}
		.scroll-box-02 {
			height: 100%;
			width: 100%;
			overflow-y: auto;
			position: relative;
		}
		.scroll-box-03 {
			height: 100%;
			width: 100%;
			overflow-y: auto;
			position: relative;
		}
		.content{
			width: 90%;
			height: 85%;
			margin: auto;
			top: -2%;
			position: relative;
		}
    </style>  
</head>  
<body>
	<div class="project-title">
		<span>42kw小功率群充项目</span>
		<div style="position: fixed; left: 84%;">
			<select name="selectProject" id="selectProject" style="background-color: #37a2da; color: #fff; border: 0.2px solid #37a2da;">
				<option value="2022">42kw小功率群充项目</option>
				<option value="2023">42kw小功率群充项目</option>
				<option value="2024" selected="selected">42kw小功率群充项目</option>
				<option value="2025">42kw小功率群充项目</option>
				<option value="2026">42kw小功率群充项目</option>
				<option value="2027">42kw小功率群充项目</option>
				<option value="2028">42kw小功率群充项目</option>
				<option value="2028">42kw小功率群充项目</option>
				<option value="2029">42kw小功率群充项目</option>
				<option value="2030">42kw小功率群充项目</option>
				<option value="2031">42kw小功率群充项目</option>
				<option value="2032">42kw小功率群充项目</option>
				<option value="2033">42kw小功率群充项目</option>
			</select>
		</div>
	</div>
	<div class="project-plan">
		<div class="project-plan-title"><span>项目计划</span></div> 
		<div class="flowchart-container">  
			<div class="stage market-insights">
				<div>市场洞察</div>
				<div class="process process-color-01" id="process">
					<span id="process01"></span>
				</div>
			</div>  
			<div class="connector">  
				<svg>  
					<defs>  
						<marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">  
							<polygon points="0 0, 10 3.5, 0 7" fill="#333" />  
						</marker>  
					</defs>
					<line x1="0" y1="12" x2="24" y2="12" />  
				</svg>  
			</div>
			
			<div class="stage opportunity-analysis">
			
				<div>机会分析</div>
				<div class="process process-color-02">
					<span id="process02"></span>
				</div>
			</div>	
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div>  
			
			<div class="stage business-plan">
				<div>业务计划</div>
				<div class="process process-color-03">
					<span id="process03"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div>
			
			<div class="stage product-initiation">
				<div>产品立项</div>
				<div class="process process-color-04">
					<span id="process04"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div>
			
			<div class="stage concept">
				<div>概念</div>
				<div class="process process-color-05">
					<span id="process05"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div> 
			
			<div class="stage planning">
				<div>计划</div>
				<div class="process process-color-06">
					<span id="process06"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div> 
			
			<div class="stage development">
				<div>开发</div>
				<div class="process process-color-07">
					<span id="process07"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div>  
			
			<div class="stage validation">
				<div>验证</div>
				<div class="process process-color-08">
					<span id="process08"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div> 
			
			<div class="stage launch">
				<div>发布</div>
				<div class="process process-color-09">
					<span id="process09"></span>
				</div>
			</div>  
			<div class="connector"><svg><line x1="0" y1="12" x2="24" y2="12" /></svg></div> 
			
			<div class="stage lifecycle">
				<div>生命周期</div>
				<div class="process process-color-10">
					<span id="process10"></span>
				</div>
			</div> 
		</div>
    </div>
	<div class="project-row-first">
		<div class="left">
			<div class="title">
				<span>项目进度</span>
			</div>
			<div class="content">
				<div class="scroll-box-02">
					<table class="scroll-tab-02" id="content02">
						<tbody class="scrollContent-02" id="scrollContent02"></tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="center">
			<div class="title">
				<span>项目缺陷</span>
			</div>
			<div class="echarts-bar" id="projectDefect"></div>
		</div>
		<div class="right">
			<div class="title">
				<span>问题闭环</span>
			</div>
			<div class="echarts-bar" id="questionCloseLoop"></div>
		</div>
		<div class="right01">
			<div class="title">
				<span>风险问题</span>
			</div>
			<div class="echarts-bar" id="risk"></div>
		</div>
	</div>
	<div class="project-row-second">
		<div class="left">
			<div class="title">
				<span>关键问题</span>
			</div>
			<div class="content">
				<div class="scroll-box-03">
					<table class="scroll-tab-03" id="content03">
						<tbody class="scrollContent-03" id="scrollContent03"></tbody>
					</table>
				</div>
			</div>
		</div>
		<div class="center">
			<div class="title">
				<span>成本信息</span>
			</div>
			<div class="echarts-bar" id="cost"></div>
			<div style="left: 55%;position: relative;height: 100%;width: 45%;top: -100%;">
				<div style="width: 100%;height: 30%;font-size: large;font-weight: bold;color: #37a2da;">
					<span>目标成本：100万</span>
				</div>
				<div style="width: 100%;height: 30%;font-size: large;font-weight: bold;color: #37a2da;">
					<span>实际成本：110万</span>
				</div>
				<div style="width: 100%;height: 30%;font-size: large;font-weight: bold;color: #37a2da;">
					<span>差额：10万</span>
				</div>
			</div>
		</div>
		<div class="right">
			<div class="title">
				<span>项目预算</span>
			</div>
			<div class="echarts-bar" id="projectBudget"></div>
		</div>
		<div class="right01">
			<div style="position: fixed; right: 4%;">
				<select name="selectYear" id="selectYear" style="background-color: #37a2da; color: #fff; border: 0.2px solid #37a2da;">
					<option value="2022">2022</option>
					<option value="2023">2023</option>
					<option value="2024" selected="selected">2024</option>
					<option value="2025">2025</option>
					<option value="2026">2026</option>
					<option value="2027">2027</option>
					<option value="2028">2028</option>
					<option value="2029">2029</option>
				</select>
			</div>
			<div class="title">
				<span>资源投入</span>
			</div>
			<div class="echarts-bar" id="source"></div>
		</div>
	</div>
	<div class="project-row-third">
		<div class="third-left">
			<div class="tabel-title">
				<span>EC变更台账</span>
			</div>
			<table class="table">
				<thead>
				<tr>
					<th style="font-size: 0.8vw; width: 5%;text-align: center">序号</th>
					<th style="font-size: 0.8vw; width: 14%;text-align: center">EC单号</th>
<!--					<th style="font-size: 0.8vw; width: 7%;text-align: center">申请时间</th>-->
					<th style="font-size: 0.8vw; width: 13%;text-align: center">申请人</th>
					<th style="font-size: 0.8vw; width: 15%;text-align: center">涉及内容</th>
					<th style="font-size: 0.8vw; width: 13%;text-align: center">当前处理人</th>
					<th style="font-size: 0.8vw; width: 10%;text-align: center">状态</th>
					<th style="font-size: 0.8vw; width: 15%;text-align: center">执行效果</th>
					<th style="font-size: 0.8vw; width: 15%;text-align: center">切入日期</th>
				</tr>
				</thead>
			</table>

			<div class="scroll-box-01">
				<table class="scroll-tab-01" id="content01">
					<tbody class="scrollContent-01" id="scrollContent01"></tbody>
				</table>
			</div>
		</div>
		<div class="third-right">
			<div class="tabel-title">
				<span>项目变更台账</span>
			</div>
			<table class="table">
				<thead>
				<tr>
					<th style="font-size: 0.8vw; width: 5%;text-align: center">序号</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">申请人</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">状态</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">变更类型</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">变更原因</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">评审类型</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">当前处理人</th>
					<th style="font-size: 0.8vw; width: 7%;text-align: center">变更批准</th>
				</tr>
				</thead>
			</table>

			<div class="scroll-box-04">
				<table class="scroll-tab-04" id="content04">
					<tbody class="scrollContent-04" id="scrollContent04"></tbody>
				</table>
			</div>
		</div>
	</div>
	<script type="text/javascript" th:src="@{/js/plugins/echarts.min.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/budgetExpen.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/cost.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/risk.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/projectDefect.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/costComp.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/questionCloseLoop.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/source.js}"></script>
	<script type="text/javascript" th:src="@{/js/xybr/project/projectBudget.js}"></script>
	<script type="text/javascript" th:src="@{/js/jquery.min.js}"></script>
	<script type="text/javascript">
		//var urls = "http://123.249.26.42:8084/xybrInterFace/";
		var urls = "http://localhost/";
		var jsonEcList = '';
		var jsonProcessList = '';
		window.onload = function (){
			document.querySelectorAll('.stage').forEach(function(element) {
				element.style.width = nowSize(60) + 'px';
				element.style.height = nowSize(60) + 'px';
				element.style.borderRadius = nowSize(5) + 'px';
				element.style.fontSize = nowSize(16) + 'px';
				element.style.margin = nowSize(0.5) + 'px';
				element.style.padding = nowSize(10) + 'px';
			});
			document.querySelectorAll('.connector').forEach(function(element) {
				element.style.width = nowSize(60) + 'px';
				element.style.height = nowSize(40) + 'px';
			});
			document.querySelectorAll('.process').forEach(function(element) {
				element.style.borderRadius = nowSize(10) + 'px';
				element.style.height = nowSize(20) + 'px';
			});
			document.querySelectorAll('.project-plan-title').forEach(function(element) {
				element.style.fontSize = nowSize(18) + 'px';
			});
			document.querySelectorAll('.title').forEach(function(element) {
				element.style.fontSize = nowSize(16) + 'px';
			});
			document.querySelectorAll('.tabel-title').forEach(function(element) {
				element.style.fontSize = nowSize(16) + 'px';
			});
			// let budget = echarts.init(document.getElementById("budget"));
			// createBudgeExp(budget,'');
			let cost = echarts.init(document.getElementById("cost"));
			createCost(cost,'');
			let projectDefect = echarts.init(document.getElementById("projectDefect"));
			createProjectDefect(projectDefect,'');
			let risk = echarts.init(document.getElementById("risk"));
			createRisk(risk,'');
			// let costComp = echarts.init(document.getElementById("costComp"));
			// createCostComp(costComp,'');
			let questionCloseLoop = echarts.init(document.getElementById("questionCloseLoop"));
			createQuestionCloseLoop(questionCloseLoop,'');
			let source = echarts.init(document.getElementById("source"));
			createSource(source,'');
			let projectBudget = echarts.init(document.getElementById("projectBudget"));
			createProjectBudget(projectBudget,'');
			queryData();
			fillProjectPlanData();
		}
		window.addEventListener('resize', function() {
			location.reload()
		});
		function fillProjectPlanData(){
			document.getElementById('process01').innerText = "100%";
			document.getElementById('process02').innerText = "100%";
			document.getElementById('process03').innerText = "100%";
			document.getElementById('process04').innerText = "100%";
			document.getElementById('process05').innerText = "100%";
			document.getElementById('process06').innerText = "100%";
			document.getElementById('process07').innerText = "80%";
			document.getElementById('process08').innerText = "90%";
			document.getElementById('process09').innerText = "";
			document.getElementById('process10').innerText = "";
		}
		function queryData(){
			$.ajax({
				type: "GET",
				url: urls + "/report/project/getEcLedger",
				contentType: "application/json;charset=utf-8",
				data: {
					"projectCode": ""
				},
				dateType: "json",
				success: function (data) {
					jsonEcList = data.ecList;
					fillDataTable();
				},
				error: function (data) {
					alert("失败");
				}
			});
		}
		function fillDataTable() {
			let ECChangeStr = '';
			let processStr = '';
			let keyQuestion = '';
			for (let n = 0; n < jsonEcList.length; n++) {
				processStr +=
						'<tr style="height: 24px;"><td style="font-size: 1vw; font-family: cursive;width: 100%;font-weight: 400;text-align: left">' +
						'1、项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目' +
						'</td></tr>';
				keyQuestion +=
						'<tr style="height: 24px;"><td style="font-size: 1vw; font-family: cursive;width: 100%;font-weight: 400;text-align: left">' +
						'1、项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目编码项目' +
						'</td></tr>';
				ECChangeStr +=
						'<tr style="height: 24px;"><td style="font-size: 0.8vw; width: 5%;font-weight: 400;text-align: center">' +
						n +
						'</td><td style="font-size: 0.8vw; width: 14%;font-weight: 400;text-align: center">' +
						jsonEcList[n].ecNo +
						// '</td><td style="font-size: 0.8vw; width: 7%;font-weight: 400;text-align: center">' +
						// jsonEcList[n].appDate +
						'</td><td style="font-size: 0.8vw; width: 13%;font-weight: 400;text-align: center">' +
						jsonEcList[n].approver +
						'</td><td style="font-size: 0.8vw; width: 15%;font-weight: 400;text-align: center">' +
						jsonEcList[n].content +
						'</td><td style="font-size: 0.8vw; width: 13%;font-weight: 400;text-align: center">' +
						'马继召' +
						'</td><td style="font-size: 0.8vw; width: 10%;font-weight: 400;text-align: center">' +
						'结束' +
						'</td><td style="font-size: 0.8vw; width: 15%;font-weight: 400;text-align: center">' +
						jsonEcList[n].effectiveness +
						'</td><td style="font-size: 0.8vw; width: 15%;font-weight: 400;text-align: center">' +
						jsonEcList[n].cutInDate +
						'</td></tr>';
			}
			$('.scrollContent-03').append(keyQuestion);
			$('.scrollContent-03').append(keyQuestion);
			$('.scrollContent-02').append(processStr);
			$('.scrollContent-02').append(processStr);
			$('.scrollContent-01').append(ECChangeStr);
			$('.scrollContent-01').append(ECChangeStr);
		}
		function nowSize(size){
			let nowClientWidth = size*(document.documentElement.clientWidth/1698);
			return nowClientWidth;
		}
		var table01 = document.getElementsByClassName('scroll-tab-01').item(0);
		var scrollContent01= document.getElementsByClassName('scroll-box-01').item(0);
		roll(50);
		//滚动函数
		function roll(t) {
			var timer = setInterval(rollStart, t); // 间隔时间t
			// 鼠标移入table时暂停滚动
			table01.onmouseover = function () {
				clearInterval(timer);
			};
			// 鼠标移出table后继续滚动
			table01.onmouseout = function () {
				timer = setInterval(rollStart, t);
			};
		}
		// 开始滚动函数
		function rollStart() {
			if (scrollContent01.scrollTop >= scrollContent01.scrollHeight / 2) {
				//注此处高度相当于为俩个tbody高度 需除2
				scrollContent01.scrollTop = 0;
			} else {
				scrollContent01.scrollTop++;
			}
		}
	</script>
</body>  
</html>